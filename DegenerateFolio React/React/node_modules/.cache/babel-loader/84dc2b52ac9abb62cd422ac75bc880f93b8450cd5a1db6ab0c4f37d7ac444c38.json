{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.connectComet = exports.isComet38Client = exports.isTendermint37Client = exports.isTendermint34Client = void 0;\nconst comet38_1 = require(\"./comet38\");\nconst tendermint34_1 = require(\"./tendermint34\");\nconst tendermint37_1 = require(\"./tendermint37\");\nfunction isTendermint34Client(client) {\n  return client instanceof tendermint34_1.Tendermint34Client;\n}\nexports.isTendermint34Client = isTendermint34Client;\nfunction isTendermint37Client(client) {\n  return client instanceof tendermint37_1.Tendermint37Client;\n}\nexports.isTendermint37Client = isTendermint37Client;\nfunction isComet38Client(client) {\n  return client instanceof comet38_1.Comet38Client;\n}\nexports.isComet38Client = isComet38Client;\n/**\n * Auto-detects the version of the backend and uses a suitable client.\n */\nasync function connectComet(endpoint) {\n  // Tendermint/CometBFT 0.34/0.37/0.38 auto-detection. Starting with 0.37 we seem to get reliable versions again ðŸŽ‰\n  // Using 0.34 as the fallback.\n  let out;\n  const tm37Client = await tendermint37_1.Tendermint37Client.connect(endpoint);\n  const version = (await tm37Client.status()).nodeInfo.version;\n  if (version.startsWith(\"0.37.\")) {\n    out = tm37Client;\n  } else if (version.startsWith(\"0.38.\")) {\n    tm37Client.disconnect();\n    out = await comet38_1.Comet38Client.connect(endpoint);\n  } else {\n    tm37Client.disconnect();\n    out = await tendermint34_1.Tendermint34Client.connect(endpoint);\n  }\n  return out;\n}\nexports.connectComet = connectComet;","map":{"version":3,"names":["comet38_1","require","tendermint34_1","tendermint37_1","isTendermint34Client","client","Tendermint34Client","exports","isTendermint37Client","Tendermint37Client","isComet38Client","Comet38Client","connectComet","endpoint","out","tm37Client","connect","version","status","nodeInfo","startsWith","disconnect"],"sources":["../src/tendermintclient.ts"],"sourcesContent":[null],"mappings":";;;;;;AAAA,MAAAA,SAAA,GAAAC,OAAA;AAEA,MAAAC,cAAA,GAAAD,OAAA;AACA,MAAAE,cAAA,GAAAF,OAAA;AAYA,SAAgBG,oBAAoBA,CAACC,MAAmB;EACtD,OAAOA,MAAM,YAAYH,cAAA,CAAAI,kBAAkB;AAC7C;AAFAC,OAAA,CAAAH,oBAAA,GAAAA,oBAAA;AAIA,SAAgBI,oBAAoBA,CAACH,MAAmB;EACtD,OAAOA,MAAM,YAAYF,cAAA,CAAAM,kBAAkB;AAC7C;AAFAF,OAAA,CAAAC,oBAAA,GAAAA,oBAAA;AAIA,SAAgBE,eAAeA,CAACL,MAAmB;EACjD,OAAOA,MAAM,YAAYL,SAAA,CAAAW,aAAa;AACxC;AAFAJ,OAAA,CAAAG,eAAA,GAAAA,eAAA;AAIA;;;AAGO,eAAeE,YAAYA,CAACC,QAA+B;EAChE;EACA;EACA,IAAIC,GAAgB;EACpB,MAAMC,UAAU,GAAG,MAAMZ,cAAA,CAAAM,kBAAkB,CAACO,OAAO,CAACH,QAAQ,CAAC;EAC7D,MAAMI,OAAO,GAAG,CAAC,MAAMF,UAAU,CAACG,MAAM,EAAE,EAAEC,QAAQ,CAACF,OAAO;EAC5D,IAAIA,OAAO,CAACG,UAAU,CAAC,OAAO,CAAC,EAAE;IAC/BN,GAAG,GAAGC,UAAU;GACjB,MAAM,IAAIE,OAAO,CAACG,UAAU,CAAC,OAAO,CAAC,EAAE;IACtCL,UAAU,CAACM,UAAU,EAAE;IACvBP,GAAG,GAAG,MAAMd,SAAA,CAAAW,aAAa,CAACK,OAAO,CAACH,QAAQ,CAAC;GAC5C,MAAM;IACLE,UAAU,CAACM,UAAU,EAAE;IACvBP,GAAG,GAAG,MAAMZ,cAAA,CAAAI,kBAAkB,CAACU,OAAO,CAACH,QAAQ,CAAC;;EAElD,OAAOC,GAAG;AACZ;AAhBAP,OAAA,CAAAK,YAAA,GAAAA,YAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}