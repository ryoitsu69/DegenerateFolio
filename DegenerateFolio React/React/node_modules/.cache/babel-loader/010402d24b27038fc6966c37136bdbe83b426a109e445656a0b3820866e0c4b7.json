{"ast":null,"code":"import { combineLatest, map, of } from 'rxjs';\nimport { memo } from '../util/index.js';\nimport { getEraCache, setEraCache } from './cache.js';\nimport { combineEras, erasHistoricApply, singleEra } from './util.js';\nconst CACHE_KEY = 'eraSlashes';\nfunction mapSlashes(era, noms, vals) {\n  const nominators = {};\n  const validators = {};\n  noms.forEach(([key, optBalance]) => {\n    nominators[key.args[1].toString()] = optBalance.unwrap();\n  });\n  vals.forEach(([key, optRes]) => {\n    validators[key.args[1].toString()] = optRes.unwrapOrDefault()[1];\n  });\n  return {\n    era,\n    nominators,\n    validators\n  };\n}\nexport function _eraSlashes(instanceId, api) {\n  return memo(instanceId, (era, withActive) => {\n    const [cacheKey, cached] = getEraCache(CACHE_KEY, era, withActive);\n    return cached ? of(cached) : combineLatest([api.query.staking.nominatorSlashInEra.entries(era), api.query.staking.validatorSlashInEra.entries(era)]).pipe(map(([n, v]) => setEraCache(cacheKey, withActive, mapSlashes(era, n, v))));\n  });\n}\nexport const eraSlashes = /*#__PURE__*/singleEra('_eraSlashes');\nexport const _erasSlashes = /*#__PURE__*/combineEras('_eraSlashes');\nexport const erasSlashes = /*#__PURE__*/erasHistoricApply('_erasSlashes');","map":{"version":3,"names":["combineLatest","map","of","memo","getEraCache","setEraCache","combineEras","erasHistoricApply","singleEra","CACHE_KEY","mapSlashes","era","noms","vals","nominators","validators","forEach","key","optBalance","args","toString","unwrap","optRes","unwrapOrDefault","_eraSlashes","instanceId","api","withActive","cacheKey","cached","query","staking","nominatorSlashInEra","entries","validatorSlashInEra","pipe","n","v","eraSlashes","_erasSlashes","erasSlashes"],"sources":["/home/ryoitsu/Documents/test/react-todo-app/node_modules/@polkadot/api-derive/staking/erasSlashes.js"],"sourcesContent":["import { combineLatest, map, of } from 'rxjs';\nimport { memo } from '../util/index.js';\nimport { getEraCache, setEraCache } from './cache.js';\nimport { combineEras, erasHistoricApply, singleEra } from './util.js';\nconst CACHE_KEY = 'eraSlashes';\nfunction mapSlashes(era, noms, vals) {\n    const nominators = {};\n    const validators = {};\n    noms.forEach(([key, optBalance]) => {\n        nominators[key.args[1].toString()] = optBalance.unwrap();\n    });\n    vals.forEach(([key, optRes]) => {\n        validators[key.args[1].toString()] = optRes.unwrapOrDefault()[1];\n    });\n    return { era, nominators, validators };\n}\nexport function _eraSlashes(instanceId, api) {\n    return memo(instanceId, (era, withActive) => {\n        const [cacheKey, cached] = getEraCache(CACHE_KEY, era, withActive);\n        return cached\n            ? of(cached)\n            : combineLatest([\n                api.query.staking.nominatorSlashInEra.entries(era),\n                api.query.staking.validatorSlashInEra.entries(era)\n            ]).pipe(map(([n, v]) => setEraCache(cacheKey, withActive, mapSlashes(era, n, v))));\n    });\n}\nexport const eraSlashes = /*#__PURE__*/ singleEra('_eraSlashes');\nexport const _erasSlashes = /*#__PURE__*/ combineEras('_eraSlashes');\nexport const erasSlashes = /*#__PURE__*/ erasHistoricApply('_erasSlashes');\n"],"mappings":"AAAA,SAASA,aAAa,EAAEC,GAAG,EAAEC,EAAE,QAAQ,MAAM;AAC7C,SAASC,IAAI,QAAQ,kBAAkB;AACvC,SAASC,WAAW,EAAEC,WAAW,QAAQ,YAAY;AACrD,SAASC,WAAW,EAAEC,iBAAiB,EAAEC,SAAS,QAAQ,WAAW;AACrE,MAAMC,SAAS,GAAG,YAAY;AAC9B,SAASC,UAAUA,CAACC,GAAG,EAAEC,IAAI,EAAEC,IAAI,EAAE;EACjC,MAAMC,UAAU,GAAG,CAAC,CAAC;EACrB,MAAMC,UAAU,GAAG,CAAC,CAAC;EACrBH,IAAI,CAACI,OAAO,CAAC,CAAC,CAACC,GAAG,EAAEC,UAAU,CAAC,KAAK;IAChCJ,UAAU,CAACG,GAAG,CAACE,IAAI,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAC,GAAGF,UAAU,CAACG,MAAM,CAAC,CAAC;EAC5D,CAAC,CAAC;EACFR,IAAI,CAACG,OAAO,CAAC,CAAC,CAACC,GAAG,EAAEK,MAAM,CAAC,KAAK;IAC5BP,UAAU,CAACE,GAAG,CAACE,IAAI,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAC,GAAGE,MAAM,CAACC,eAAe,CAAC,CAAC,CAAC,CAAC,CAAC;EACpE,CAAC,CAAC;EACF,OAAO;IAAEZ,GAAG;IAAEG,UAAU;IAAEC;EAAW,CAAC;AAC1C;AACA,OAAO,SAASS,WAAWA,CAACC,UAAU,EAAEC,GAAG,EAAE;EACzC,OAAOvB,IAAI,CAACsB,UAAU,EAAE,CAACd,GAAG,EAAEgB,UAAU,KAAK;IACzC,MAAM,CAACC,QAAQ,EAAEC,MAAM,CAAC,GAAGzB,WAAW,CAACK,SAAS,EAAEE,GAAG,EAAEgB,UAAU,CAAC;IAClE,OAAOE,MAAM,GACP3B,EAAE,CAAC2B,MAAM,CAAC,GACV7B,aAAa,CAAC,CACZ0B,GAAG,CAACI,KAAK,CAACC,OAAO,CAACC,mBAAmB,CAACC,OAAO,CAACtB,GAAG,CAAC,EAClDe,GAAG,CAACI,KAAK,CAACC,OAAO,CAACG,mBAAmB,CAACD,OAAO,CAACtB,GAAG,CAAC,CACrD,CAAC,CAACwB,IAAI,CAAClC,GAAG,CAAC,CAAC,CAACmC,CAAC,EAAEC,CAAC,CAAC,KAAKhC,WAAW,CAACuB,QAAQ,EAAED,UAAU,EAAEjB,UAAU,CAACC,GAAG,EAAEyB,CAAC,EAAEC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC1F,CAAC,CAAC;AACN;AACA,OAAO,MAAMC,UAAU,GAAG,aAAc9B,SAAS,CAAC,aAAa,CAAC;AAChE,OAAO,MAAM+B,YAAY,GAAG,aAAcjC,WAAW,CAAC,aAAa,CAAC;AACpE,OAAO,MAAMkC,WAAW,GAAG,aAAcjC,iBAAiB,CAAC,cAAc,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}