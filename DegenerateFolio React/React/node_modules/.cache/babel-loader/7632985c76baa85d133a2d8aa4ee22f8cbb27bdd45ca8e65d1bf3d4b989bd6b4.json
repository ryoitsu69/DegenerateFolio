{"ast":null,"code":"import { BehaviorSubject, combineLatest, map, of, switchMap, tap, toArray } from 'rxjs';\nimport { arrayChunk, arrayFlatten, nextTick } from '@polkadot/util';\nimport { memo } from '../util/index.js';\nconst ERA_CHUNK_SIZE = 14;\nfunction chunkEras(eras, fn) {\n  const chunked = arrayChunk(eras, ERA_CHUNK_SIZE);\n  let index = 0;\n  const subject = new BehaviorSubject(chunked[index]);\n  return subject.pipe(switchMap(fn), tap(() => {\n    nextTick(() => {\n      index++;\n      index === chunked.length ? subject.complete() : subject.next(chunked[index]);\n    });\n  }), toArray(), map(arrayFlatten));\n}\nexport function filterEras(eras, list) {\n  return eras.filter(e => !list.some(_ref => {\n    let {\n      era\n    } = _ref;\n    return e.eq(era);\n  }));\n}\nexport function erasHistoricApply(fn) {\n  return (instanceId, api) =>\n  // Cannot quite get the typing right, but it is right in the code\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n  memo(instanceId, function () {\n    let withActive = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    return api.derive.staking.erasHistoric(withActive).pipe(switchMap(e => api.derive.staking[fn](e, withActive)));\n  });\n}\nexport function erasHistoricApplyAccount(fn) {\n  return (instanceId, api) =>\n  // Cannot quite get the typing right, but it is right in the code\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n  memo(instanceId, function (accountId) {\n    let withActive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    return api.derive.staking.erasHistoric(withActive).pipe(switchMap(e => api.derive.staking[fn](accountId, e, withActive)));\n  });\n}\nexport function singleEra(fn) {\n  return (instanceId, api) =>\n  // Cannot quite get the typing right, but it is right in the code\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n  memo(instanceId, era => api.derive.staking[fn](era, true));\n}\nexport function combineEras(fn) {\n  return (instanceId, api) =>\n  // Cannot quite get the typing right, but it is right in the code\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n  memo(instanceId, (eras, withActive) => !eras.length ? of([]) : chunkEras(eras, eras => combineLatest(eras.map(e => api.derive.staking[fn](e, withActive)))));\n}","map":{"version":3,"names":["BehaviorSubject","combineLatest","map","of","switchMap","tap","toArray","arrayChunk","arrayFlatten","nextTick","memo","ERA_CHUNK_SIZE","chunkEras","eras","fn","chunked","index","subject","pipe","length","complete","next","filterEras","list","filter","e","some","_ref","era","eq","erasHistoricApply","instanceId","api","withActive","arguments","undefined","derive","staking","erasHistoric","erasHistoricApplyAccount","accountId","singleEra","combineEras"],"sources":["/home/ryoitsu/Documents/test/react-todo-app/node_modules/@polkadot/api-derive/staking/util.js"],"sourcesContent":["import { BehaviorSubject, combineLatest, map, of, switchMap, tap, toArray } from 'rxjs';\nimport { arrayChunk, arrayFlatten, nextTick } from '@polkadot/util';\nimport { memo } from '../util/index.js';\nconst ERA_CHUNK_SIZE = 14;\nfunction chunkEras(eras, fn) {\n    const chunked = arrayChunk(eras, ERA_CHUNK_SIZE);\n    let index = 0;\n    const subject = new BehaviorSubject(chunked[index]);\n    return subject.pipe(switchMap(fn), tap(() => {\n        nextTick(() => {\n            index++;\n            index === chunked.length\n                ? subject.complete()\n                : subject.next(chunked[index]);\n        });\n    }), toArray(), map(arrayFlatten));\n}\nexport function filterEras(eras, list) {\n    return eras.filter((e) => !list.some(({ era }) => e.eq(era)));\n}\nexport function erasHistoricApply(fn) {\n    return (instanceId, api) => \n    // Cannot quite get the typing right, but it is right in the code\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    memo(instanceId, (withActive = false) => api.derive.staking.erasHistoric(withActive).pipe(switchMap((e) => api.derive.staking[fn](e, withActive))));\n}\nexport function erasHistoricApplyAccount(fn) {\n    return (instanceId, api) => \n    // Cannot quite get the typing right, but it is right in the code\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    memo(instanceId, (accountId, withActive = false) => api.derive.staking.erasHistoric(withActive).pipe(switchMap((e) => api.derive.staking[fn](accountId, e, withActive))));\n}\nexport function singleEra(fn) {\n    return (instanceId, api) => \n    // Cannot quite get the typing right, but it is right in the code\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    memo(instanceId, (era) => api.derive.staking[fn](era, true));\n}\nexport function combineEras(fn) {\n    return (instanceId, api) => \n    // Cannot quite get the typing right, but it is right in the code\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    memo(instanceId, (eras, withActive) => !eras.length\n        ? of([])\n        : chunkEras(eras, (eras) => combineLatest(eras.map((e) => api.derive.staking[fn](e, withActive)))));\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}