{"ast":null,"code":"import { Buffer } from 'buffer';\nimport * as txnBuilder from './transaction';\nimport * as nacl from './nacl/naclWrappers';\nimport * as encoding from './encoding/encoding';\nimport * as address from './encoding/address';\nimport * as utils from './utils/utils';\nconst ALGORAND_MAX_TX_GROUP_SIZE = 16;\n/**\n * Aux class for group id calculation of a group of transactions\n */\nexport class TxGroup {\n  constructor(hashes) {\n    this.name = 'Transaction group';\n    this.tag = Buffer.from('TG');\n    if (hashes.length > ALGORAND_MAX_TX_GROUP_SIZE) {\n      const errorMsg = \"\".concat(hashes.length.toString(), \" transactions grouped together but max group size is \").concat(ALGORAND_MAX_TX_GROUP_SIZE.toString());\n      throw Error(errorMsg);\n    }\n    this.txGroupHashes = hashes;\n  }\n  // eslint-disable-next-line camelcase\n  get_obj_for_encoding() {\n    const txgroup = {\n      txlist: this.txGroupHashes\n    };\n    return txgroup;\n  }\n  // eslint-disable-next-line camelcase\n  static from_obj_for_encoding(txgroupForEnc) {\n    const txn = Object.create(this.prototype);\n    txn.name = 'Transaction group';\n    txn.tag = Buffer.from('TG');\n    txn.txGroupHashes = [];\n    for (const hash of txgroupForEnc.txlist) {\n      txn.txGroupHashes.push(Buffer.from(hash));\n    }\n    return txn;\n  }\n  toByte() {\n    return encoding.encode(this.get_obj_for_encoding());\n  }\n}\n/**\n * computeGroupID returns group ID for a group of transactions\n * @param txns - array of transactions (every element is a dict or Transaction)\n * @returns Buffer\n */\nexport function computeGroupID(txns) {\n  const hashes = [];\n  for (const txn of txns) {\n    const tx = txnBuilder.instantiateTxnIfNeeded(txn);\n    hashes.push(tx.rawTxID());\n  }\n  const txgroup = new TxGroup(hashes);\n  const bytes = txgroup.toByte();\n  const toBeHashed = Buffer.from(utils.concatArrays(txgroup.tag, bytes));\n  const gid = nacl.genericHash(toBeHashed);\n  return Buffer.from(gid);\n}\n/**\n * assignGroupID assigns group id to a given list of unsigned transactions\n * @param txns - array of transactions (every element is a dict or Transaction)\n * @param from - optional sender address specifying which transaction return\n * @returns possible list of matching transactions\n */\nexport function assignGroupID(txns, from) {\n  const gid = computeGroupID(txns);\n  const result = [];\n  for (const txn of txns) {\n    const tx = txnBuilder.instantiateTxnIfNeeded(txn);\n    if (!from || address.encodeAddress(tx.from.publicKey) === from) {\n      tx.group = gid;\n      result.push(tx);\n    }\n  }\n  return result;\n}\nexport default TxGroup;","map":{"version":3,"names":["Buffer","txnBuilder","nacl","encoding","address","utils","ALGORAND_MAX_TX_GROUP_SIZE","TxGroup","constructor","hashes","name","tag","from","length","errorMsg","concat","toString","Error","txGroupHashes","get_obj_for_encoding","txgroup","txlist","from_obj_for_encoding","txgroupForEnc","txn","Object","create","prototype","hash","push","toByte","encode","computeGroupID","txns","tx","instantiateTxnIfNeeded","rawTxID","bytes","toBeHashed","concatArrays","gid","genericHash","assignGroupID","result","encodeAddress","publicKey","group"],"sources":["/home/ryoitsu/Documents/test/react-todo-app/node_modules/algosdk/src/group.ts"],"sourcesContent":["import { Buffer } from 'buffer';\nimport * as txnBuilder from './transaction';\nimport * as nacl from './nacl/naclWrappers';\nimport * as encoding from './encoding/encoding';\nimport * as address from './encoding/address';\nimport * as utils from './utils/utils';\n\nconst ALGORAND_MAX_TX_GROUP_SIZE = 16;\n\ninterface EncodedTxGroup {\n  txlist: Buffer[];\n}\n\n/**\n * Aux class for group id calculation of a group of transactions\n */\nexport class TxGroup {\n  name = 'Transaction group';\n  tag = Buffer.from('TG');\n  txGroupHashes: Buffer[];\n\n  constructor(hashes: Buffer[]) {\n    if (hashes.length > ALGORAND_MAX_TX_GROUP_SIZE) {\n      const errorMsg = `${hashes.length.toString()} transactions grouped together but max group size is ${ALGORAND_MAX_TX_GROUP_SIZE.toString()}`;\n      throw Error(errorMsg);\n    }\n\n    this.txGroupHashes = hashes;\n  }\n\n  // eslint-disable-next-line camelcase\n  get_obj_for_encoding() {\n    const txgroup: EncodedTxGroup = {\n      txlist: this.txGroupHashes,\n    };\n    return txgroup;\n  }\n\n  // eslint-disable-next-line camelcase\n  static from_obj_for_encoding(txgroupForEnc: EncodedTxGroup) {\n    const txn = Object.create(this.prototype);\n    txn.name = 'Transaction group';\n    txn.tag = Buffer.from('TG');\n    txn.txGroupHashes = [];\n    for (const hash of txgroupForEnc.txlist) {\n      txn.txGroupHashes.push(Buffer.from(hash));\n    }\n    return txn;\n  }\n\n  toByte() {\n    return encoding.encode(this.get_obj_for_encoding());\n  }\n}\n\n/**\n * computeGroupID returns group ID for a group of transactions\n * @param txns - array of transactions (every element is a dict or Transaction)\n * @returns Buffer\n */\nexport function computeGroupID(txns: txnBuilder.TransactionLike[]) {\n  const hashes = [];\n  for (const txn of txns) {\n    const tx = txnBuilder.instantiateTxnIfNeeded(txn);\n    hashes.push(tx.rawTxID());\n  }\n\n  const txgroup = new TxGroup(hashes);\n\n  const bytes = txgroup.toByte();\n  const toBeHashed = Buffer.from(utils.concatArrays(txgroup.tag, bytes));\n  const gid = nacl.genericHash(toBeHashed);\n  return Buffer.from(gid);\n}\n\n/**\n * assignGroupID assigns group id to a given list of unsigned transactions\n * @param txns - array of transactions (every element is a dict or Transaction)\n * @param from - optional sender address specifying which transaction return\n * @returns possible list of matching transactions\n */\nexport function assignGroupID(\n  txns: txnBuilder.TransactionLike[],\n  from?: string\n) {\n  const gid = computeGroupID(txns);\n  const result: txnBuilder.Transaction[] = [];\n  for (const txn of txns) {\n    const tx = txnBuilder.instantiateTxnIfNeeded(txn);\n    if (!from || address.encodeAddress(tx.from.publicKey) === from) {\n      tx.group = gid;\n      result.push(tx);\n    }\n  }\n  return result;\n}\n\nexport default TxGroup;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}