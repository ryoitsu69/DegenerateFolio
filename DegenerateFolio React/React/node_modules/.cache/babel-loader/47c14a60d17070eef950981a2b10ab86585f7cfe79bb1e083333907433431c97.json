{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.pbkdf2Sha512 = exports.pbkdf2Sha512Noble = exports.pbkdf2Sha512NodeCrypto = exports.pbkdf2Sha512Subtle = exports.getSubtle = exports.getNodeCrypto = void 0;\nconst utils_1 = require(\"@cosmjs/utils\");\nconst pbkdf2_1 = require(\"@noble/hashes/pbkdf2\");\nconst sha512_1 = require(\"@noble/hashes/sha512\");\n/**\n * Returns the Node.js crypto module when available and `undefined`\n * otherwise.\n *\n * Detects an unimplemented fallback module from Webpack 5 and returns\n * `undefined` in that case.\n */\nasync function getNodeCrypto() {\n  try {\n    const nodeCrypto = await Promise.resolve().then(() => __importStar(require(\"crypto\")));\n    // We get `Object{default: Object{}}` as a fallback when using\n    // `crypto: false` in Webpack 5, which we interprete as unavailable.\n    if (typeof nodeCrypto === \"object\" && Object.keys(nodeCrypto).length <= 1) {\n      return undefined;\n    }\n    return nodeCrypto;\n  } catch {\n    return undefined;\n  }\n}\nexports.getNodeCrypto = getNodeCrypto;\nasync function getSubtle() {\n  // From Node.js 15 onwards, webcrypto is available in globalThis.\n  // In version 15 and 16 this was stored under the webcrypto key.\n  // With Node.js 17 it was moved to the same locations where browsers\n  // make it available.\n  // Loading `require(\"crypto\")` here seems unnecessary since it only\n  // causes issues with bundlers and does not increase compatibility.\n  // Browsers and Node.js 17+\n  let subtle = globalThis?.crypto?.subtle;\n  // Node.js 15+\n  if (!subtle) subtle = globalThis?.crypto?.webcrypto?.subtle;\n  return subtle;\n}\nexports.getSubtle = getSubtle;\nasync function pbkdf2Sha512Subtle(\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nsubtle, secret, salt, iterations, keylen) {\n  (0, utils_1.assert)(subtle, \"Argument subtle is falsy\");\n  (0, utils_1.assert)(typeof subtle === \"object\", \"Argument subtle is not of type object\");\n  (0, utils_1.assert)(typeof subtle.importKey === \"function\", \"subtle.importKey is not a function\");\n  (0, utils_1.assert)(typeof subtle.deriveBits === \"function\", \"subtle.deriveBits is not a function\");\n  return subtle.importKey(\"raw\", secret, {\n    name: \"PBKDF2\"\n  }, false, [\"deriveBits\"]).then(key => subtle.deriveBits({\n    name: \"PBKDF2\",\n    salt: salt,\n    iterations: iterations,\n    hash: {\n      name: \"SHA-512\"\n    }\n  }, key, keylen * 8).then(buffer => new Uint8Array(buffer)));\n}\nexports.pbkdf2Sha512Subtle = pbkdf2Sha512Subtle;\n/**\n * Implements pbkdf2-sha512 using the Node.js crypro module (`import \"crypto\"`).\n * This does not use subtle from [Crypto](https://developer.mozilla.org/en-US/docs/Web/API/Crypto).\n */\nasync function pbkdf2Sha512NodeCrypto(\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nnodeCrypto, secret, salt, iterations, keylen) {\n  (0, utils_1.assert)(nodeCrypto, \"Argument nodeCrypto is falsy\");\n  (0, utils_1.assert)(typeof nodeCrypto === \"object\", \"Argument nodeCrypto is not of type object\");\n  (0, utils_1.assert)(typeof nodeCrypto.pbkdf2 === \"function\", \"nodeCrypto.pbkdf2 is not a function\");\n  return new Promise((resolve, reject) => {\n    nodeCrypto.pbkdf2(secret, salt, iterations, keylen, \"sha512\", (error, result) => {\n      if (error) {\n        reject(error);\n      } else {\n        resolve(Uint8Array.from(result));\n      }\n    });\n  });\n}\nexports.pbkdf2Sha512NodeCrypto = pbkdf2Sha512NodeCrypto;\nasync function pbkdf2Sha512Noble(secret, salt, iterations, keylen) {\n  return (0, pbkdf2_1.pbkdf2Async)(sha512_1.sha512, secret, salt, {\n    c: iterations,\n    dkLen: keylen\n  });\n}\nexports.pbkdf2Sha512Noble = pbkdf2Sha512Noble;\n/**\n * A pbkdf2 implementation for BIP39. This is not exported at package level and thus a private API.\n */\nasync function pbkdf2Sha512(secret, salt, iterations, keylen) {\n  const subtle = await getSubtle();\n  if (subtle) {\n    return pbkdf2Sha512Subtle(subtle, secret, salt, iterations, keylen);\n  } else {\n    const nodeCrypto = await getNodeCrypto();\n    if (nodeCrypto) {\n      return pbkdf2Sha512NodeCrypto(nodeCrypto, secret, salt, iterations, keylen);\n    } else {\n      return pbkdf2Sha512Noble(secret, salt, iterations, keylen);\n    }\n  }\n}\nexports.pbkdf2Sha512 = pbkdf2Sha512;","map":{"version":3,"names":["utils_1","require","pbkdf2_1","sha512_1","getNodeCrypto","nodeCrypto","Promise","resolve","then","__importStar","Object","keys","length","undefined","exports","getSubtle","subtle","globalThis","crypto","webcrypto","pbkdf2Sha512Subtle","secret","salt","iterations","keylen","assert","importKey","deriveBits","name","key","hash","buffer","Uint8Array","pbkdf2Sha512NodeCrypto","pbkdf2","reject","error","result","from","pbkdf2Sha512Noble","pbkdf2Async","sha512","c","dkLen","pbkdf2Sha512"],"sources":["../src/pbkdf2.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}