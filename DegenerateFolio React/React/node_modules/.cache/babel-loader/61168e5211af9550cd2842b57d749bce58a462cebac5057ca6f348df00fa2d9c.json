{"ast":null,"code":"import { from, of, switchMap } from 'rxjs';\nimport { memo } from '../util/index.js';\n/**\n * Returns a header range from startHash to to (not including) endHash, i.e. lastBlock.parentHash === endHash\n */\nexport function _getHeaderRange(instanceId, api) {\n  return memo(instanceId, (startHash, endHash, prev = []) => api.rpc.chain.getHeader(startHash).pipe(switchMap(header => header.parentHash.eq(endHash) ? of([header, ...prev]) : api.derive.chain._getHeaderRange(header.parentHash, endHash, [header, ...prev]))));\n}\n/**\n * @name subscribeFinalizedHeads\n * @description An observable of the finalized block headers. Unlike the base\n * chain.subscribeFinalizedHeads this does not skip any headers. Since finalization\n * may skip specific blocks (finalization happens in terms of chains), this version\n * of the derive tracks missing headers (since last  retrieved) and provides them\n * to the caller\n */\nexport function subscribeFinalizedHeads(instanceId, api) {\n  return memo(instanceId, () => {\n    let prevHash = null;\n    return api.rpc.chain.subscribeFinalizedHeads().pipe(switchMap(header => {\n      const endHash = prevHash;\n      const startHash = header.parentHash;\n      prevHash = header.createdAtHash = header.hash;\n      return endHash === null || startHash.eq(endHash) ? of(header) : api.derive.chain._getHeaderRange(startHash, endHash, [header]).pipe(switchMap(headers => from(headers)));\n    }));\n  });\n}","map":{"version":3,"names":["from","of","switchMap","memo","_getHeaderRange","instanceId","api","startHash","endHash","prev","rpc","chain","getHeader","pipe","header","parentHash","eq","derive","subscribeFinalizedHeads","prevHash","createdAtHash","hash","headers"],"sources":["/home/ryoitsu/Documents/test/react-todo-app/node_modules/@polkadot/api-derive/chain/subscribeFinalizedHeads.js"],"sourcesContent":["import { from, of, switchMap } from 'rxjs';\nimport { memo } from '../util/index.js';\n/**\n * Returns a header range from startHash to to (not including) endHash, i.e. lastBlock.parentHash === endHash\n */\nexport function _getHeaderRange(instanceId, api) {\n    return memo(instanceId, (startHash, endHash, prev = []) => api.rpc.chain.getHeader(startHash).pipe(switchMap((header) => header.parentHash.eq(endHash)\n        ? of([header, ...prev])\n        : api.derive.chain._getHeaderRange(header.parentHash, endHash, [header, ...prev]))));\n}\n/**\n * @name subscribeFinalizedHeads\n * @description An observable of the finalized block headers. Unlike the base\n * chain.subscribeFinalizedHeads this does not skip any headers. Since finalization\n * may skip specific blocks (finalization happens in terms of chains), this version\n * of the derive tracks missing headers (since last  retrieved) and provides them\n * to the caller\n */\nexport function subscribeFinalizedHeads(instanceId, api) {\n    return memo(instanceId, () => {\n        let prevHash = null;\n        return api.rpc.chain.subscribeFinalizedHeads().pipe(switchMap((header) => {\n            const endHash = prevHash;\n            const startHash = header.parentHash;\n            prevHash = header.createdAtHash = header.hash;\n            return endHash === null || startHash.eq(endHash)\n                ? of(header)\n                : api.derive.chain._getHeaderRange(startHash, endHash, [header]).pipe(switchMap((headers) => from(headers)));\n        }));\n    });\n}\n"],"mappings":"AAAA,SAASA,IAAI,EAAEC,EAAE,EAAEC,SAAS,QAAQ,MAAM;AAC1C,SAASC,IAAI,QAAQ,kBAAkB;AACvC;AACA;AACA;AACA,OAAO,SAASC,eAAeA,CAACC,UAAU,EAAEC,GAAG,EAAE;EAC7C,OAAOH,IAAI,CAACE,UAAU,EAAE,CAACE,SAAS,EAAEC,OAAO,EAAEC,IAAI,GAAG,EAAE,KAAKH,GAAG,CAACI,GAAG,CAACC,KAAK,CAACC,SAAS,CAACL,SAAS,CAAC,CAACM,IAAI,CAACX,SAAS,CAAEY,MAAM,IAAKA,MAAM,CAACC,UAAU,CAACC,EAAE,CAACR,OAAO,CAAC,GAChJP,EAAE,CAAC,CAACa,MAAM,EAAE,GAAGL,IAAI,CAAC,CAAC,GACrBH,GAAG,CAACW,MAAM,CAACN,KAAK,CAACP,eAAe,CAACU,MAAM,CAACC,UAAU,EAAEP,OAAO,EAAE,CAACM,MAAM,EAAE,GAAGL,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASS,uBAAuBA,CAACb,UAAU,EAAEC,GAAG,EAAE;EACrD,OAAOH,IAAI,CAACE,UAAU,EAAE,MAAM;IAC1B,IAAIc,QAAQ,GAAG,IAAI;IACnB,OAAOb,GAAG,CAACI,GAAG,CAACC,KAAK,CAACO,uBAAuB,CAAC,CAAC,CAACL,IAAI,CAACX,SAAS,CAAEY,MAAM,IAAK;MACtE,MAAMN,OAAO,GAAGW,QAAQ;MACxB,MAAMZ,SAAS,GAAGO,MAAM,CAACC,UAAU;MACnCI,QAAQ,GAAGL,MAAM,CAACM,aAAa,GAAGN,MAAM,CAACO,IAAI;MAC7C,OAAOb,OAAO,KAAK,IAAI,IAAID,SAAS,CAACS,EAAE,CAACR,OAAO,CAAC,GAC1CP,EAAE,CAACa,MAAM,CAAC,GACVR,GAAG,CAACW,MAAM,CAACN,KAAK,CAACP,eAAe,CAACG,SAAS,EAAEC,OAAO,EAAE,CAACM,MAAM,CAAC,CAAC,CAACD,IAAI,CAACX,SAAS,CAAEoB,OAAO,IAAKtB,IAAI,CAACsB,OAAO,CAAC,CAAC,CAAC;IACpH,CAAC,CAAC,CAAC;EACP,CAAC,CAAC;AACN","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}