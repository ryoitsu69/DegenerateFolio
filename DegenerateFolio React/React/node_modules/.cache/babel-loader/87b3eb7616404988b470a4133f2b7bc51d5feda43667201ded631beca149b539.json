{"ast":null,"code":"import { combineLatest, map, of, switchMap } from 'rxjs';\nimport { isFunction, objectSpread } from '@polkadot/util';\nimport { memo } from '../util/index.js';\nimport { getImageHashBounded } from './util.js';\nfunction isNewDepositors(depositors) {\n  // Detect balance...\n  return isFunction(depositors[1].mul);\n}\nfunction parse([proposals, images, optDepositors]) {\n  return proposals.filter(([,, proposer], index) => !!optDepositors[index]?.isSome && !proposer.isEmpty).map(([index, hash, proposer], proposalIndex) => {\n    const depositors = optDepositors[proposalIndex].unwrap();\n    return objectSpread({\n      image: images[proposalIndex],\n      imageHash: getImageHashBounded(hash),\n      index,\n      proposer\n    }, isNewDepositors(depositors) ? {\n      balance: depositors[1],\n      seconds: depositors[0]\n    } : {\n      balance: depositors[0],\n      seconds: depositors[1]\n    });\n  });\n}\nexport function proposals(instanceId, api) {\n  return memo(instanceId, () => isFunction(api.query.democracy?.publicProps) ? api.query.democracy.publicProps().pipe(switchMap(proposals => proposals.length ? combineLatest([of(proposals), api.derive.democracy.preimages(proposals.map(([, hash]) => hash)), api.query.democracy.depositOf.multi(proposals.map(([index]) => index))]) : of([[], [], []])), map(parse)) : of([]));\n}","map":{"version":3,"names":["combineLatest","map","of","switchMap","isFunction","objectSpread","memo","getImageHashBounded","isNewDepositors","depositors","mul","parse","proposals","images","optDepositors","filter","proposer","index","isSome","isEmpty","hash","proposalIndex","unwrap","image","imageHash","balance","seconds","instanceId","api","query","democracy","publicProps","pipe","length","derive","preimages","depositOf","multi"],"sources":["/home/ryoitsu/Documents/test/react-todo-app/node_modules/@polkadot/api-derive/democracy/proposals.js"],"sourcesContent":["import { combineLatest, map, of, switchMap } from 'rxjs';\nimport { isFunction, objectSpread } from '@polkadot/util';\nimport { memo } from '../util/index.js';\nimport { getImageHashBounded } from './util.js';\nfunction isNewDepositors(depositors) {\n    // Detect balance...\n    return isFunction(depositors[1].mul);\n}\nfunction parse([proposals, images, optDepositors]) {\n    return proposals\n        .filter(([, , proposer], index) => !!(optDepositors[index]?.isSome) && !proposer.isEmpty)\n        .map(([index, hash, proposer], proposalIndex) => {\n        const depositors = optDepositors[proposalIndex].unwrap();\n        return objectSpread({\n            image: images[proposalIndex],\n            imageHash: getImageHashBounded(hash),\n            index,\n            proposer\n        }, isNewDepositors(depositors)\n            ? { balance: depositors[1], seconds: depositors[0] }\n            : { balance: depositors[0], seconds: depositors[1] });\n    });\n}\nexport function proposals(instanceId, api) {\n    return memo(instanceId, () => isFunction(api.query.democracy?.publicProps)\n        ? api.query.democracy.publicProps().pipe(switchMap((proposals) => proposals.length\n            ? combineLatest([\n                of(proposals),\n                api.derive.democracy.preimages(proposals.map(([, hash]) => hash)),\n                api.query.democracy.depositOf.multi(proposals.map(([index]) => index))\n            ])\n            : of([[], [], []])), map(parse))\n        : of([]));\n}\n"],"mappings":"AAAA,SAASA,aAAa,EAAEC,GAAG,EAAEC,EAAE,EAAEC,SAAS,QAAQ,MAAM;AACxD,SAASC,UAAU,EAAEC,YAAY,QAAQ,gBAAgB;AACzD,SAASC,IAAI,QAAQ,kBAAkB;AACvC,SAASC,mBAAmB,QAAQ,WAAW;AAC/C,SAASC,eAAeA,CAACC,UAAU,EAAE;EACjC;EACA,OAAOL,UAAU,CAACK,UAAU,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC;AACxC;AACA,SAASC,KAAKA,CAAC,CAACC,SAAS,EAAEC,MAAM,EAAEC,aAAa,CAAC,EAAE;EAC/C,OAAOF,SAAS,CACXG,MAAM,CAAC,CAAC,IAAKC,QAAQ,CAAC,EAAEC,KAAK,KAAK,CAAC,CAAEH,aAAa,CAACG,KAAK,CAAC,EAAEC,MAAO,IAAI,CAACF,QAAQ,CAACG,OAAO,CAAC,CACxFlB,GAAG,CAAC,CAAC,CAACgB,KAAK,EAAEG,IAAI,EAAEJ,QAAQ,CAAC,EAAEK,aAAa,KAAK;IACjD,MAAMZ,UAAU,GAAGK,aAAa,CAACO,aAAa,CAAC,CAACC,MAAM,CAAC,CAAC;IACxD,OAAOjB,YAAY,CAAC;MAChBkB,KAAK,EAAEV,MAAM,CAACQ,aAAa,CAAC;MAC5BG,SAAS,EAAEjB,mBAAmB,CAACa,IAAI,CAAC;MACpCH,KAAK;MACLD;IACJ,CAAC,EAAER,eAAe,CAACC,UAAU,CAAC,GACxB;MAAEgB,OAAO,EAAEhB,UAAU,CAAC,CAAC,CAAC;MAAEiB,OAAO,EAAEjB,UAAU,CAAC,CAAC;IAAE,CAAC,GAClD;MAAEgB,OAAO,EAAEhB,UAAU,CAAC,CAAC,CAAC;MAAEiB,OAAO,EAAEjB,UAAU,CAAC,CAAC;IAAE,CAAC,CAAC;EAC7D,CAAC,CAAC;AACN;AACA,OAAO,SAASG,SAASA,CAACe,UAAU,EAAEC,GAAG,EAAE;EACvC,OAAOtB,IAAI,CAACqB,UAAU,EAAE,MAAMvB,UAAU,CAACwB,GAAG,CAACC,KAAK,CAACC,SAAS,EAAEC,WAAW,CAAC,GACpEH,GAAG,CAACC,KAAK,CAACC,SAAS,CAACC,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC7B,SAAS,CAAES,SAAS,IAAKA,SAAS,CAACqB,MAAM,GAC5EjC,aAAa,CAAC,CACZE,EAAE,CAACU,SAAS,CAAC,EACbgB,GAAG,CAACM,MAAM,CAACJ,SAAS,CAACK,SAAS,CAACvB,SAAS,CAACX,GAAG,CAAC,CAAC,GAAGmB,IAAI,CAAC,KAAKA,IAAI,CAAC,CAAC,EACjEQ,GAAG,CAACC,KAAK,CAACC,SAAS,CAACM,SAAS,CAACC,KAAK,CAACzB,SAAS,CAACX,GAAG,CAAC,CAAC,CAACgB,KAAK,CAAC,KAAKA,KAAK,CAAC,CAAC,CACzE,CAAC,GACAf,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAED,GAAG,CAACU,KAAK,CAAC,CAAC,GAClCT,EAAE,CAAC,EAAE,CAAC,CAAC;AACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}