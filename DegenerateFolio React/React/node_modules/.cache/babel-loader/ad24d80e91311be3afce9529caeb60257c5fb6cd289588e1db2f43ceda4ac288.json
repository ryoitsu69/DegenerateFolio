{"ast":null,"code":"import EventEmitter from 'eventemitter3';\nimport { uid } from '../../../../utils/data/uid.mjs';\nimport { deprecation, v8_0_0 } from '../../../../utils/logging/deprecation.mjs';\n\"use strict\";\nconst idHash = /* @__PURE__ */Object.create(null);\nfunction createResourceIdFromString(value) {\n  const id = idHash[value];\n  if (id === void 0) {\n    idHash[value] = uid(\"resource\");\n  }\n  return id;\n}\nconst _TextureStyle = class _TextureStyle extends EventEmitter {\n  /**\n   * @param options - options for the style\n   */\n  constructor(options = {}) {\n    super();\n    this._resourceType = \"textureSampler\";\n    this._touched = 0;\n    /**\n     * Specifies the maximum anisotropy value clamp used by the sampler.\n     * Note: Most implementations support {@link GPUSamplerDescriptor#maxAnisotropy} values in range\n     * between 1 and 16, inclusive. The used value of {@link GPUSamplerDescriptor#maxAnisotropy} will\n     * be clamped to the maximum value that the platform supports.\n     * @internal\n     * @ignore\n     */\n    this._maxAnisotropy = 1;\n    /**\n     * Has the style been destroyed?\n     * @readonly\n     */\n    this.destroyed = false;\n    options = {\n      ..._TextureStyle.defaultOptions,\n      ...options\n    };\n    this.addressMode = options.addressMode;\n    this.addressModeU = options.addressModeU ?? this.addressModeU;\n    this.addressModeV = options.addressModeV ?? this.addressModeV;\n    this.addressModeW = options.addressModeW ?? this.addressModeW;\n    this.scaleMode = options.scaleMode;\n    this.magFilter = options.magFilter ?? this.magFilter;\n    this.minFilter = options.minFilter ?? this.minFilter;\n    this.mipmapFilter = options.mipmapFilter ?? this.mipmapFilter;\n    this.lodMinClamp = options.lodMinClamp;\n    this.lodMaxClamp = options.lodMaxClamp;\n    this.compare = options.compare;\n    this.maxAnisotropy = options.maxAnisotropy ?? 1;\n  }\n  set addressMode(value) {\n    this.addressModeU = value;\n    this.addressModeV = value;\n    this.addressModeW = value;\n  }\n  /** setting this will set wrapModeU,wrapModeV and wrapModeW all at once! */\n  get addressMode() {\n    return this.addressModeU;\n  }\n  set wrapMode(value) {\n    deprecation(v8_0_0, \"TextureStyle.wrapMode is now TextureStyle.addressMode\");\n    this.addressMode = value;\n  }\n  get wrapMode() {\n    return this.addressMode;\n  }\n  set scaleMode(value) {\n    this.magFilter = value;\n    this.minFilter = value;\n    this.mipmapFilter = value;\n  }\n  /** setting this will set magFilter,minFilter and mipmapFilter all at once!  */\n  get scaleMode() {\n    return this.magFilter;\n  }\n  /** Specifies the maximum anisotropy value clamp used by the sampler. */\n  set maxAnisotropy(value) {\n    this._maxAnisotropy = Math.min(value, 16);\n    if (this._maxAnisotropy > 1) {\n      this.scaleMode = \"linear\";\n    }\n  }\n  get maxAnisotropy() {\n    return this._maxAnisotropy;\n  }\n  // TODO - move this to WebGL?\n  get _resourceId() {\n    return this._sharedResourceId || this._generateResourceId();\n  }\n  update() {\n    this.emit(\"change\", this);\n    this._sharedResourceId = null;\n  }\n  _generateResourceId() {\n    const bigKey = `${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;\n    this._sharedResourceId = createResourceIdFromString(bigKey);\n    return this._resourceId;\n  }\n  /** Destroys the style */\n  destroy() {\n    this.destroyed = true;\n    this.emit(\"destroy\", this);\n    this.emit(\"change\", this);\n    this.removeAllListeners();\n  }\n};\n/** default options for the style */\n_TextureStyle.defaultOptions = {\n  addressMode: \"clamp-to-edge\",\n  scaleMode: \"linear\"\n};\nlet TextureStyle = _TextureStyle;\nexport { TextureStyle };","map":{"version":3,"names":["idHash","Object","create","createResourceIdFromString","value","id","uid","_TextureStyle","EventEmitter","constructor","options","_resourceType","_touched","_maxAnisotropy","destroyed","defaultOptions","addressMode","addressModeU","addressModeV","addressModeW","scaleMode","magFilter","minFilter","mipmapFilter","lodMinClamp","lodMaxClamp","compare","maxAnisotropy","wrapMode","deprecation","v8_0_0","Math","min","_resourceId","_sharedResourceId","_generateResourceId","update","emit","bigKey","destroy","removeAllListeners","TextureStyle"],"sources":["/home/ryoitsu/node_modules/pixi.js/src/rendering/renderers/shared/texture/TextureStyle.ts"],"sourcesContent":["import EventEmitter from 'eventemitter3';\nimport { uid } from '../../../../utils/data/uid';\nimport { deprecation, v8_0_0 } from '../../../../utils/logging/deprecation';\n\nimport type { BindResource } from '../../gpu/shader/BindResource';\nimport type { COMPARE_FUNCTION, SCALE_MODE, WRAP_MODE } from './const';\n\nconst idHash: Record<string, number> = Object.create(null);\n\n/**\n * This takes a shader string and maps it to a resource id.\n * This is a little different than regular resource ids as these ids\n * are not unique to the resource. But must not overlap with other (non sampler) resources Ids.\n * @param value - the string to turn into a resource id\n * @returns a unique resource id\n */\nfunction createResourceIdFromString(value: string): number\n{\n    const id = idHash[value];\n\n    if (id === undefined)\n    {\n        idHash[value] = uid('resource');\n    }\n\n    return id;\n}\n\nexport interface TextureStyleOptions extends Partial<TextureStyle>\n{\n    /** setting this will set wrapModeU,wrapModeV and wrapModeW all at once! */\n    addressMode?: WRAP_MODE;\n    /** specifies the {{GPUAddressMode|address modes}} for the texture width, height, and depth coordinates, respectively. */\n    addressModeU?: WRAP_MODE;\n    /** specifies the {{GPUAddressMode|address modes}} for the texture width, height, and depth coordinates, respectively. */\n    addressModeV?: WRAP_MODE;\n    /** Specifies the {{GPUAddressMode|address modes}} for the texture width, height, and depth coordinates, respectively. */\n    addressModeW?: WRAP_MODE;\n\n    /** setting this will set magFilter,minFilter and mipmapFilter all at once!  */\n    scaleMode?: SCALE_MODE;\n\n    /** specifies the sampling behavior when the sample footprint is smaller than or equal to one texel. */\n    magFilter?: SCALE_MODE;\n    /** specifies the sampling behavior when the sample footprint is larger than one texel. */\n    minFilter?: SCALE_MODE;\n    /** specifies behavior for sampling between mipmap levels. */\n    mipmapFilter?: SCALE_MODE;\n\n    /** specifies the minimum and maximum levels of detail, respectively, used internally when sampling a texture. */\n    lodMinClamp?: number;\n    /** Specifies the minimum and maximum levels of detail, respectively, used internally when sampling a texture. */\n    lodMaxClamp?: number;\n    /**\n     * When provided the sampler will be a comparison sampler with the specified\n     * {@link GPUCompareFunction}.\n     * Note: Comparison samplers may use filtering, but the sampling results will be\n     * implementation-dependent and may differ from the normal filtering rules.\n     */\n    compare?: COMPARE_FUNCTION;\n    /**\n     * Specifies the maximum anisotropy value clamp used by the sampler.\n     * Note: Most implementations support {@link GPUSamplerDescriptor#maxAnisotropy} values in range\n     * between 1 and 16, inclusive. The used value of {@link GPUSamplerDescriptor#maxAnisotropy} will\n     * be clamped to the maximum value that the platform supports.\n     *\n     * setting this to anything higher than 1 will set scale modes to 'linear'\n     */\n    maxAnisotropy?: number;\n}\n\n/**\n * A texture style describes how a texture should be sampled by a shader.\n * @memberof rendering\n */\nexport class TextureStyle extends EventEmitter<{\n    change: TextureStyle,\n    destroy: TextureStyle,\n}> implements BindResource\n{\n    public _resourceType = 'textureSampler';\n    public _touched = 0;\n    private _sharedResourceId: number;\n\n    /** default options for the style */\n    public static readonly defaultOptions: TextureStyleOptions = {\n        addressMode: 'clamp-to-edge',\n        scaleMode: 'linear'\n    };\n\n    /** */\n    public addressModeU?: WRAP_MODE;\n    /** */\n    public addressModeV?: WRAP_MODE;\n    /** Specifies the {{GPUAddressMode|address modes}} for the texture width, height, and depth coordinates, respectively. */\n    public addressModeW?: WRAP_MODE;\n    /** Specifies the sampling behavior when the sample footprint is smaller than or equal to one texel. */\n    public magFilter?: SCALE_MODE;\n    /** Specifies the sampling behavior when the sample footprint is larger than one texel. */\n    public minFilter?: SCALE_MODE;\n    /** Specifies behavior for sampling between mipmap levels. */\n    public mipmapFilter?: SCALE_MODE;\n    /** */\n    public lodMinClamp?: number;\n    /** Specifies the minimum and maximum levels of detail, respectively, used internally when sampling a texture. */\n    public lodMaxClamp?: number;\n    /**\n     * When provided the sampler will be a comparison sampler with the specified\n     * {@link GPUCompareFunction}.\n     * Note: Comparison samplers may use filtering, but the sampling results will be\n     * implementation-dependent and may differ from the normal filtering rules.\n     */\n    public compare?: COMPARE_FUNCTION;\n    /**\n     * Specifies the maximum anisotropy value clamp used by the sampler.\n     * Note: Most implementations support {@link GPUSamplerDescriptor#maxAnisotropy} values in range\n     * between 1 and 16, inclusive. The used value of {@link GPUSamplerDescriptor#maxAnisotropy} will\n     * be clamped to the maximum value that the platform supports.\n     * @internal\n     * @ignore\n     */\n    public _maxAnisotropy?: number = 1;\n\n    /**\n     * Has the style been destroyed?\n     * @readonly\n     */\n    public destroyed = false;\n\n    /**\n     * @param options - options for the style\n     */\n    constructor(options: TextureStyleOptions = {})\n    {\n        super();\n\n        options = { ...TextureStyle.defaultOptions, ...options };\n\n        this.addressMode = options.addressMode;\n\n        this.addressModeU = options.addressModeU ?? this.addressModeU;\n        this.addressModeV = options.addressModeV ?? this.addressModeV;\n        this.addressModeW = options.addressModeW ?? this.addressModeW;\n\n        this.scaleMode = options.scaleMode;\n\n        this.magFilter = options.magFilter ?? this.magFilter;\n        this.minFilter = options.minFilter ?? this.minFilter;\n        this.mipmapFilter = options.mipmapFilter ?? this.mipmapFilter;\n\n        this.lodMinClamp = options.lodMinClamp;\n        this.lodMaxClamp = options.lodMaxClamp;\n\n        this.compare = options.compare;\n\n        this.maxAnisotropy = options.maxAnisotropy ?? 1;\n    }\n\n    set addressMode(value: WRAP_MODE)\n    {\n        this.addressModeU = value;\n        this.addressModeV = value;\n        this.addressModeW = value;\n    }\n\n    /** setting this will set wrapModeU,wrapModeV and wrapModeW all at once! */\n    get addressMode(): WRAP_MODE\n    {\n        return this.addressModeU;\n    }\n\n    set wrapMode(value: WRAP_MODE)\n    {\n        // #if _DEBUG\n        deprecation(v8_0_0, 'TextureStyle.wrapMode is now TextureStyle.addressMode');\n        // #endif\n\n        this.addressMode = value;\n    }\n\n    get wrapMode(): WRAP_MODE\n    {\n        return this.addressMode;\n    }\n\n    set scaleMode(value: SCALE_MODE)\n    {\n        this.magFilter = value;\n        this.minFilter = value;\n        this.mipmapFilter = value;\n    }\n\n    /** setting this will set magFilter,minFilter and mipmapFilter all at once!  */\n    get scaleMode(): SCALE_MODE\n    {\n        return this.magFilter;\n    }\n\n    /** Specifies the maximum anisotropy value clamp used by the sampler. */\n    set maxAnisotropy(value: number)\n    {\n        this._maxAnisotropy = Math.min(value, 16);\n\n        if (this._maxAnisotropy > 1)\n        {\n            this.scaleMode = 'linear';\n        }\n    }\n\n    get maxAnisotropy(): number\n    {\n        return this._maxAnisotropy;\n    }\n\n    // TODO - move this to WebGL?\n    get _resourceId(): number\n    {\n        return this._sharedResourceId || this._generateResourceId();\n    }\n\n    public update()\n    {\n        // manage the resource..\n        this.emit('change', this);\n        this._sharedResourceId = null;\n    }\n\n    private _generateResourceId(): number\n    {\n        // eslint-disable-next-line max-len\n        const bigKey = `${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;\n\n        this._sharedResourceId = createResourceIdFromString(bigKey);\n\n        return this._resourceId;\n    }\n\n    /** Destroys the style */\n    public destroy()\n    {\n        this.destroyed = true;\n\n        this.emit('destroy', this);\n        this.emit('change', this);\n\n        this.removeAllListeners();\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}