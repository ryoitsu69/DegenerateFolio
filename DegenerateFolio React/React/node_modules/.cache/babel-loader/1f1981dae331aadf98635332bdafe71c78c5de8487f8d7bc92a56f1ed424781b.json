{"ast":null,"code":"import { combineLatest, map, of } from 'rxjs';\nimport { memo } from '../util/index.js';\nimport { getEraCache, setEraCache } from './cache.js';\nimport { combineEras, erasHistoricApply, singleEra } from './util.js';\nconst CACHE_KEY = 'eraSlashes';\nfunction mapSlashes(era, noms, vals) {\n  const nominators = {};\n  const validators = {};\n  noms.forEach(_ref => {\n    let [key, optBalance] = _ref;\n    nominators[key.args[1].toString()] = optBalance.unwrap();\n  });\n  vals.forEach(_ref2 => {\n    let [key, optRes] = _ref2;\n    validators[key.args[1].toString()] = optRes.unwrapOrDefault()[1];\n  });\n  return {\n    era,\n    nominators,\n    validators\n  };\n}\nexport function _eraSlashes(instanceId, api) {\n  return memo(instanceId, (era, withActive) => {\n    const [cacheKey, cached] = getEraCache(CACHE_KEY, era, withActive);\n    return cached ? of(cached) : combineLatest([api.query.staking.nominatorSlashInEra.entries(era), api.query.staking.validatorSlashInEra.entries(era)]).pipe(map(_ref3 => {\n      let [n, v] = _ref3;\n      return setEraCache(cacheKey, withActive, mapSlashes(era, n, v));\n    }));\n  });\n}\nexport const eraSlashes = /*#__PURE__*/singleEra('_eraSlashes');\nexport const _erasSlashes = /*#__PURE__*/combineEras('_eraSlashes');\nexport const erasSlashes = /*#__PURE__*/erasHistoricApply('_erasSlashes');","map":{"version":3,"names":["combineLatest","map","of","memo","getEraCache","setEraCache","combineEras","erasHistoricApply","singleEra","CACHE_KEY","mapSlashes","era","noms","vals","nominators","validators","forEach","_ref","key","optBalance","args","toString","unwrap","_ref2","optRes","unwrapOrDefault","_eraSlashes","instanceId","api","withActive","cacheKey","cached","query","staking","nominatorSlashInEra","entries","validatorSlashInEra","pipe","_ref3","n","v","eraSlashes","_erasSlashes","erasSlashes"],"sources":["/home/ryoitsu/Documents/test/react-todo-app/node_modules/@polkadot/api-derive/staking/erasSlashes.js"],"sourcesContent":["import { combineLatest, map, of } from 'rxjs';\nimport { memo } from '../util/index.js';\nimport { getEraCache, setEraCache } from './cache.js';\nimport { combineEras, erasHistoricApply, singleEra } from './util.js';\nconst CACHE_KEY = 'eraSlashes';\nfunction mapSlashes(era, noms, vals) {\n    const nominators = {};\n    const validators = {};\n    noms.forEach(([key, optBalance]) => {\n        nominators[key.args[1].toString()] = optBalance.unwrap();\n    });\n    vals.forEach(([key, optRes]) => {\n        validators[key.args[1].toString()] = optRes.unwrapOrDefault()[1];\n    });\n    return { era, nominators, validators };\n}\nexport function _eraSlashes(instanceId, api) {\n    return memo(instanceId, (era, withActive) => {\n        const [cacheKey, cached] = getEraCache(CACHE_KEY, era, withActive);\n        return cached\n            ? of(cached)\n            : combineLatest([\n                api.query.staking.nominatorSlashInEra.entries(era),\n                api.query.staking.validatorSlashInEra.entries(era)\n            ]).pipe(map(([n, v]) => setEraCache(cacheKey, withActive, mapSlashes(era, n, v))));\n    });\n}\nexport const eraSlashes = /*#__PURE__*/ singleEra('_eraSlashes');\nexport const _erasSlashes = /*#__PURE__*/ combineEras('_eraSlashes');\nexport const erasSlashes = /*#__PURE__*/ erasHistoricApply('_erasSlashes');\n"],"mappings":"AAAA,SAASA,aAAa,EAAEC,GAAG,EAAEC,EAAE,QAAQ,MAAM;AAC7C,SAASC,IAAI,QAAQ,kBAAkB;AACvC,SAASC,WAAW,EAAEC,WAAW,QAAQ,YAAY;AACrD,SAASC,WAAW,EAAEC,iBAAiB,EAAEC,SAAS,QAAQ,WAAW;AACrE,MAAMC,SAAS,GAAG,YAAY;AAC9B,SAASC,UAAUA,CAACC,GAAG,EAAEC,IAAI,EAAEC,IAAI,EAAE;EACjC,MAAMC,UAAU,GAAG,CAAC,CAAC;EACrB,MAAMC,UAAU,GAAG,CAAC,CAAC;EACrBH,IAAI,CAACI,OAAO,CAACC,IAAA,IAAuB;IAAA,IAAtB,CAACC,GAAG,EAAEC,UAAU,CAAC,GAAAF,IAAA;IAC3BH,UAAU,CAACI,GAAG,CAACE,IAAI,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAC,GAAGF,UAAU,CAACG,MAAM,CAAC,CAAC;EAC5D,CAAC,CAAC;EACFT,IAAI,CAACG,OAAO,CAACO,KAAA,IAAmB;IAAA,IAAlB,CAACL,GAAG,EAAEM,MAAM,CAAC,GAAAD,KAAA;IACvBR,UAAU,CAACG,GAAG,CAACE,IAAI,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAC,GAAGG,MAAM,CAACC,eAAe,CAAC,CAAC,CAAC,CAAC,CAAC;EACpE,CAAC,CAAC;EACF,OAAO;IAAEd,GAAG;IAAEG,UAAU;IAAEC;EAAW,CAAC;AAC1C;AACA,OAAO,SAASW,WAAWA,CAACC,UAAU,EAAEC,GAAG,EAAE;EACzC,OAAOzB,IAAI,CAACwB,UAAU,EAAE,CAAChB,GAAG,EAAEkB,UAAU,KAAK;IACzC,MAAM,CAACC,QAAQ,EAAEC,MAAM,CAAC,GAAG3B,WAAW,CAACK,SAAS,EAAEE,GAAG,EAAEkB,UAAU,CAAC;IAClE,OAAOE,MAAM,GACP7B,EAAE,CAAC6B,MAAM,CAAC,GACV/B,aAAa,CAAC,CACZ4B,GAAG,CAACI,KAAK,CAACC,OAAO,CAACC,mBAAmB,CAACC,OAAO,CAACxB,GAAG,CAAC,EAClDiB,GAAG,CAACI,KAAK,CAACC,OAAO,CAACG,mBAAmB,CAACD,OAAO,CAACxB,GAAG,CAAC,CACrD,CAAC,CAAC0B,IAAI,CAACpC,GAAG,CAACqC,KAAA;MAAA,IAAC,CAACC,CAAC,EAAEC,CAAC,CAAC,GAAAF,KAAA;MAAA,OAAKjC,WAAW,CAACyB,QAAQ,EAAED,UAAU,EAAEnB,UAAU,CAACC,GAAG,EAAE4B,CAAC,EAAEC,CAAC,CAAC,CAAC;IAAA,EAAC,CAAC;EAC1F,CAAC,CAAC;AACN;AACA,OAAO,MAAMC,UAAU,GAAG,aAAcjC,SAAS,CAAC,aAAa,CAAC;AAChE,OAAO,MAAMkC,YAAY,GAAG,aAAcpC,WAAW,CAAC,aAAa,CAAC;AACpE,OAAO,MAAMqC,WAAW,GAAG,aAAcpC,iBAAiB,CAAC,cAAc,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}