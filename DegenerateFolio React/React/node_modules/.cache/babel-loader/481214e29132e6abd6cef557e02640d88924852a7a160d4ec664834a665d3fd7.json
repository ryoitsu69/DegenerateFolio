{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.serializeSignDoc = exports.escapeCharacters = exports.makeSignDoc = exports.sortedJsonStringify = void 0;\n/* eslint-disable @typescript-eslint/naming-convention */\nconst encoding_1 = require(\"@cosmjs/encoding\");\nconst math_1 = require(\"@cosmjs/math\");\nfunction sortedObject(obj) {\n  if (typeof obj !== \"object\" || obj === null) {\n    return obj;\n  }\n  if (Array.isArray(obj)) {\n    return obj.map(sortedObject);\n  }\n  const sortedKeys = Object.keys(obj).sort();\n  const result = {};\n  // NOTE: Use forEach instead of reduce for performance with large objects eg Wasm code\n  sortedKeys.forEach(key => {\n    result[key] = sortedObject(obj[key]);\n  });\n  return result;\n}\n/** Returns a JSON string with objects sorted by key */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nfunction sortedJsonStringify(obj) {\n  return JSON.stringify(sortedObject(obj));\n}\nexports.sortedJsonStringify = sortedJsonStringify;\nfunction makeSignDoc(msgs, fee, chainId, memo, accountNumber, sequence, timeout_height) {\n  return {\n    chain_id: chainId,\n    account_number: math_1.Uint53.fromString(accountNumber.toString()).toString(),\n    sequence: math_1.Uint53.fromString(sequence.toString()).toString(),\n    fee: fee,\n    msgs: msgs,\n    memo: memo || \"\",\n    ...(timeout_height && {\n      timeout_height: timeout_height.toString()\n    })\n  };\n}\nexports.makeSignDoc = makeSignDoc;\n/**\n * Takes a valid JSON document and performs the following escapings in string values:\n *\n * `&` -> `\\u0026`\n * `<` -> `\\u003c`\n * `>` -> `\\u003e`\n *\n * Since those characters do not occur in other places of the JSON document, only\n * string values are affected.\n *\n * If the input is invalid JSON, the behaviour is undefined.\n */\nfunction escapeCharacters(input) {\n  // When we migrate to target es2021 or above, we can use replaceAll instead of global patterns.\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replaceAll\n  const amp = /&/g;\n  const lt = /</g;\n  const gt = />/g;\n  return input.replace(amp, \"\\\\u0026\").replace(lt, \"\\\\u003c\").replace(gt, \"\\\\u003e\");\n}\nexports.escapeCharacters = escapeCharacters;\nfunction serializeSignDoc(signDoc) {\n  const serialized = escapeCharacters(sortedJsonStringify(signDoc));\n  return (0, encoding_1.toUtf8)(serialized);\n}\nexports.serializeSignDoc = serializeSignDoc;","map":{"version":3,"names":["encoding_1","require","math_1","sortedObject","obj","Array","isArray","map","sortedKeys","Object","keys","sort","result","forEach","key","sortedJsonStringify","JSON","stringify","exports","makeSignDoc","msgs","fee","chainId","memo","accountNumber","sequence","timeout_height","chain_id","account_number","Uint53","fromString","toString","escapeCharacters","input","amp","lt","gt","replace","serializeSignDoc","signDoc","serialized","toUtf8"],"sources":["../src/signdoc.ts"],"sourcesContent":[null],"mappings":";;;;;;AAAA;AACA,MAAAA,UAAA,GAAAC,OAAA;AACA,MAAAC,MAAA,GAAAD,OAAA;AAiCA,SAASE,YAAYA,CAACC,GAAQ;EAC5B,IAAI,OAAOA,GAAG,KAAK,QAAQ,IAAIA,GAAG,KAAK,IAAI,EAAE;IAC3C,OAAOA,GAAG;;EAEZ,IAAIC,KAAK,CAACC,OAAO,CAACF,GAAG,CAAC,EAAE;IACtB,OAAOA,GAAG,CAACG,GAAG,CAACJ,YAAY,CAAC;;EAE9B,MAAMK,UAAU,GAAGC,MAAM,CAACC,IAAI,CAACN,GAAG,CAAC,CAACO,IAAI,EAAE;EAC1C,MAAMC,MAAM,GAAwB,EAAE;EACtC;EACAJ,UAAU,CAACK,OAAO,CAAEC,GAAG,IAAI;IACzBF,MAAM,CAACE,GAAG,CAAC,GAAGX,YAAY,CAACC,GAAG,CAACU,GAAG,CAAC,CAAC;EACtC,CAAC,CAAC;EACF,OAAOF,MAAM;AACf;AAEA;AACA;AACA,SAAgBG,mBAAmBA,CAACX,GAAQ;EAC1C,OAAOY,IAAI,CAACC,SAAS,CAACd,YAAY,CAACC,GAAG,CAAC,CAAC;AAC1C;AAFAc,OAAA,CAAAH,mBAAA,GAAAA,mBAAA;AAIA,SAAgBI,WAAWA,CACzBC,IAAyB,EACzBC,GAAW,EACXC,OAAe,EACfC,IAAwB,EACxBC,aAA8B,EAC9BC,QAAyB,EACzBC,cAAuB;EAEvB,OAAO;IACLC,QAAQ,EAAEL,OAAO;IACjBM,cAAc,EAAE1B,MAAA,CAAA2B,MAAM,CAACC,UAAU,CAACN,aAAa,CAACO,QAAQ,EAAE,CAAC,CAACA,QAAQ,EAAE;IACtEN,QAAQ,EAAEvB,MAAA,CAAA2B,MAAM,CAACC,UAAU,CAACL,QAAQ,CAACM,QAAQ,EAAE,CAAC,CAACA,QAAQ,EAAE;IAC3DV,GAAG,EAAEA,GAAG;IACRD,IAAI,EAAEA,IAAI;IACVG,IAAI,EAAEA,IAAI,IAAI,EAAE;IAChB,IAAIG,cAAc,IAAI;MAAEA,cAAc,EAAEA,cAAc,CAACK,QAAQ;IAAE,CAAE;GACpE;AACH;AAlBAb,OAAA,CAAAC,WAAA,GAAAA,WAAA;AAoBA;;;;;;;;;;;;AAYA,SAAgBa,gBAAgBA,CAACC,KAAa;EAC5C;EACA;EACA,MAAMC,GAAG,GAAG,IAAI;EAChB,MAAMC,EAAE,GAAG,IAAI;EACf,MAAMC,EAAE,GAAG,IAAI;EACf,OAAOH,KAAK,CAACI,OAAO,CAACH,GAAG,EAAE,SAAS,CAAC,CAACG,OAAO,CAACF,EAAE,EAAE,SAAS,CAAC,CAACE,OAAO,CAACD,EAAE,EAAE,SAAS,CAAC;AACpF;AAPAlB,OAAA,CAAAc,gBAAA,GAAAA,gBAAA;AASA,SAAgBM,gBAAgBA,CAACC,OAAmB;EAClD,MAAMC,UAAU,GAAGR,gBAAgB,CAACjB,mBAAmB,CAACwB,OAAO,CAAC,CAAC;EACjE,OAAO,IAAAvC,UAAA,CAAAyC,MAAM,EAACD,UAAU,CAAC;AAC3B;AAHAtB,OAAA,CAAAoB,gBAAA,GAAAA,gBAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}